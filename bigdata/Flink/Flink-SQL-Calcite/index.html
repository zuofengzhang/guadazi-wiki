<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Flink SQL是Flink API的最顶层抽象，在使用Flink SQL的时候，是否被其便捷和高效惊艳到？到底一条SQL语句是如何运行起来的？提到Flink SQL，离不开SQL引擎框架 – Calcite。Calcite是面向Hadoop的查询引擎，提供了SQL解析、优化、多重数据源查询的基础框架。Flink借助Calcite实现了SQL解析、优化和graph生成。  Flink API与">
<meta property="og:type" content="article">
<meta property="og:title" content="Flink-SQL原理之Calcite">
<meta property="og:url" content="http://example.com/bigdata/Flink/Flink-SQL-Calcite/index.html">
<meta property="og:site_name" content="Guadazi">
<meta property="og:description" content="Flink SQL是Flink API的最顶层抽象，在使用Flink SQL的时候，是否被其便捷和高效惊艳到？到底一条SQL语句是如何运行起来的？提到Flink SQL，离不开SQL引擎框架 – Calcite。Calcite是面向Hadoop的查询引擎，提供了SQL解析、优化、多重数据源查询的基础框架。Flink借助Calcite实现了SQL解析、优化和graph生成。  Flink API与">
<meta property="og:locale">
<meta property="og:image" content="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418105609.png">
<meta property="og:image" content="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418225117.png">
<meta property="og:image" content="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418173928.png">
<meta property="og:image" content="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418181320.png">
<meta property="og:image" content="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418181402.png">
<meta property="og:image" content="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418184009.png">
<meta property="og:image" content="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418190336.png">
<meta property="og:image" content="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418224641.png">
<meta property="og:image" content="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418225006.png">
<meta property="article:published_time" content="2021-04-17T23:58:00.000Z">
<meta property="article:modified_time" content="2021-04-24T04:58:52.095Z">
<meta property="article:author" content="aaronzhang">
<meta property="article:tag" content="Flink">
<meta property="article:tag" content="Calcite">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418105609.png">

<link rel="canonical" href="http://example.com/bigdata/Flink/Flink-SQL-Calcite/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>Flink-SQL原理之Calcite | Guadazi</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Guadazi</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/bigdata/Flink/Flink-SQL-Calcite/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="aaronzhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Guadazi">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Flink-SQL原理之Calcite
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-04-18 07:58:00" itemprop="dateCreated datePublished" datetime="2021-04-18T07:58:00+08:00">2021-04-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-04-24 12:58:52" itemprop="dateModified" datetime="2021-04-24T12:58:52+08:00">2021-04-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bigdata/" itemprop="url" rel="index"><span itemprop="name">bigdata</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote>
<p>Flink SQL是Flink API的最顶层抽象，在使用Flink SQL的时候，是否被其便捷和高效惊艳到？到底一条SQL语句是如何运行起来的？提到Flink SQL，离不开SQL引擎框架 – Calcite。Calcite是面向Hadoop的查询引擎，提供了SQL解析、优化、多重数据源查询的基础框架。Flink借助Calcite实现了SQL解析、优化和graph生成。</p>
</blockquote>
<h2 id="Flink-API与Flink-SQL简介"><a href="#Flink-API与Flink-SQL简介" class="headerlink" title="Flink API与Flink SQL简介"></a>Flink API与Flink SQL简介</h2><p><img src="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418105609.png" alt="img"></p>
<p>Flink提供了三层API抽象，每一层API都是便捷性和变现力之前的权衡，来应对不同的计算场景。</p>
<p>Flink SQL是最顶层的抽象，这层抽象在语义和程序表达式上都类似于Table API，但是程序实现都是SQL表达式: </p>
<ol>
<li><p>SQL和Table API都是遵循关系模型：元数据和操作</p>
<ul>
<li>元数据类似于关系型数据库中的schema</li>
<li>操作类似于关系型数据库中的操作, 如select、project、join、group-by和aggregate</li>
</ul>
</li>
<li><p>SQL和Table API都是声明式定义，而不会执行执行的具体代码</p>
</li>
<li><p>简洁，通过UDF扩展，但比core API的表达能力差</p>
</li>
<li><p>执行之前，通过优化器中的优化规则对用户编写的表达式进行优化</p>
</li>
<li><p>TableEnvironment是Flink SQL和Table API的入口，可以无缝切换到DataStream/DataSet, 允许混用。</p>
</li>
</ol>
<h2 id="Calcite"><a href="#Calcite" class="headerlink" title="Calcite"></a>Calcite</h2><h3 id="Calcite简介"><a href="#Calcite简介" class="headerlink" title="Calcite简介"></a>Calcite简介</h3><p>是一个动态数据的管理框架，可以用来构建数据库系统的语法解析模块</p>
<ul>
<li>不包含数据存储、数据处理等功能</li>
<li>可以通过编写 Adaptor 来扩展功能，以支持不同的数据处理平台</li>
<li>Flink SQL 使用并对其扩展以支持 SQL 语句的解析和验证</li>
</ul>
<p>Calcite提供了SQL parser、SQL validation、Query optimizer、SQL generator和Data federator</p>
<h3 id="查询的执行过程"><a href="#查询的执行过程" class="headerlink" title="查询的执行过程"></a>查询的执行过程</h3><p>分四步: </p>
<p><img src="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418225117.png" alt="img"></p>
<ol>
<li>Parse(SQL -&gt; SqlNode ):  使用JavaCC生成的parser来转换查询</li>
<li>validate(SqlNode -&gt; SqlNode ): 通过元数据验证查询</li>
<li>optimize: 逻辑计划优化和转换为物理计划<ul>
<li>语义分析(SqlNode -&gt; RelNode/RexNode ): 根据 SqlNode 及元信息构建 RelNode 树，也就是最初版本的逻辑计划（Logical Plan）；</li>
<li>逻辑计划优化(RelNode -&gt; RelNode ): 优化器的核心，根据前面生成的逻辑计划按照相应的规则（Rule）进行优化；</li>
</ul>
</li>
<li>execute: 物理计划转换为应用框架的执行逻辑(如Flink的graph)</li>
</ol>
<h3 id="Catalog"><a href="#Catalog" class="headerlink" title="Catalog"></a>Catalog</h3><p>定义Calcite查询的命名空间:</p>
<p><code>Schema</code> :  <code>schema</code>和<code>table</code>的集合，可以任意嵌套</p>
<p><code>Table</code>: 代表单个数据集，字段定义为<code>RelDataType</code></p>
<p><code>RelDataType</code>:  代表数据集中的字段，支持所有的SQL数据类型，包括结构体</p>
<p><code>Statistic</code>: 提供用于优化的表统计信息, 如行数、分布信息、是否为key</p>
<p><img src="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418173928.png" alt="image-20210418173928391"></p>
<h3 id="SQL-parser"><a href="#SQL-parser" class="headerlink" title="SQL parser"></a>SQL parser</h3><ul>
<li>LL(K) parser通过JavaCC(Java Compiler Compiler)写的</li>
<li>输入的查询转换为AST(abstract syntax tree)</li>
<li><code>SqlNode</code>代表Token</li>
<li><code>SqlNode</code>可以通过<code>unparse</code>方法转换会SQL</li>
</ul>
<p><img src="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418181320.png" alt="image-20210418181320343"></p>
<p><code>SqlNode</code>代表AST中的一个节点</p>
<p><img src="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418181402.png" alt="image-20210418181402108"></p>
<p><code>SqlDialect</code>代表特定数据库的方言规则</p>
<h3 id="Query-optimizer"><a href="#Query-optimizer" class="headerlink" title="Query optimizer"></a>Query optimizer</h3><p>查询计划(Query plans)代表执行一个查询必须的步骤</p>
<p><img src="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418184009.png" alt="image-20210418184009836"></p>
<p>Query优化:</p>
<ul>
<li>优化逻辑计划</li>
<li>目标通常是尽量减少计划中必须在早期处理的数据量</li>
<li>将逻辑计划转换为物理计划</li>
<li>物理计划与引擎有关，代表了物理执行过程</li>
</ul>
<p>常见的优化方法:</p>
<table>
<thead>
<tr>
<th><strong>RBO</strong></th>
<th><strong>规则名称</strong></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>列裁剪</td>
<td>column_prune</td>
<td>Prune unused fields</td>
</tr>
<tr>
<td>子查询去关联</td>
<td>decorrelate</td>
<td></td>
</tr>
<tr>
<td>子查询转换为join</td>
<td></td>
<td>Convert subqueries to joins</td>
</tr>
<tr>
<td>聚合消除</td>
<td>aggregation_eliminate</td>
<td></td>
</tr>
<tr>
<td>投影消除</td>
<td>projection_eliminate</td>
<td></td>
</tr>
<tr>
<td>最大最小消除</td>
<td>max_min_eliminate</td>
<td></td>
</tr>
<tr>
<td>谓词下推</td>
<td>predicate_push_down</td>
<td></td>
</tr>
<tr>
<td>外连接消除</td>
<td>outer_join_eliminate</td>
<td></td>
</tr>
<tr>
<td>分区裁剪</td>
<td>partition_processor</td>
<td></td>
</tr>
<tr>
<td>聚合下推</td>
<td>aggregation_push_down</td>
<td></td>
</tr>
<tr>
<td>TopN 下推</td>
<td>topn_push_down</td>
<td></td>
</tr>
<tr>
<td>Join 重排序</td>
<td>join_reorder</td>
<td></td>
</tr>
</tbody></table>
<p><img src="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418190336.png" alt="image-20210418190335990"></p>
<h3 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h3><ol>
<li><strong>关系代数</strong>（Relational algebra）：即关系表达式。它们通常以动词命名，例如 Sort, Join, Project, Filter, Scan, Sample.</li>
<li><strong>行表达式</strong>（Row expressions）：例如 RexLiteral (常量), RexVariable (变量), RexCall (调用) 等，例如投影列表（Project）、过滤规则列表（Filter）、JOIN 条件列表和 ORDER BY 列表、WINDOW 表达式、函数调用等。使用 RexBuilder 来构建行表达式。</li>
<li>表达式有各种<strong>特征</strong>（Trait）：使用 Trait 的 satisfies() 方法来测试某个表达式是否符合某 Trait 或 Convention.</li>
<li><strong>转化特征</strong>（Convention）：属于 Trait 的子类，用于转化 RelNode 到具体平台实现（可以将下文提到的 Planner 注册到 Convention 中）. 例如 JdbcConvention，FlinkConventions.DATASTREAM 等。同一个关系表达式的输入必须来自单个数据源，各表达式之间通过 Converter 生成的 Bridge 来连接。</li>
<li><strong>规则</strong>（Rules）：用于将一个表达式转换（Transform）为另一个表达式。它有一个由 RelOptRuleOperand 组成的列表来决定是否可将规则应用于树的某部分。</li>
</ol>
<h3 id="Planner-规划器"><a href="#Planner-规划器" class="headerlink" title="Planner(规划器)"></a>Planner(规划器)</h3><p><strong>规划器</strong>（Planner） ：即请求优化器，它可以根据一系列规则和成本模型（例如基于成本的优化模型 VolcanoPlanner、启发式优化模型 HepPlanner）来将一个表达式转为语义等价（但效率更优）的另一个表达式。</p>
<h4 id="HepPlanner-启发式优化模型"><a href="#HepPlanner-启发式优化模型" class="headerlink" title="HepPlanner(启发式优化模型)"></a>HepPlanner(启发式优化模型)</h4><ul>
<li>与Spark优化器类似的启发式优化器</li>
<li>启发式优化比CBO要快速</li>
<li>如果规则对计划做出相反的改变，则存在无限递归的风险</li>
</ul>
<h4 id=""><a href="#" class="headerlink" title=""></a></h4><h4 id="VolcanoPlanner-基于成本的优化模型"><a href="#VolcanoPlanner-基于成本的优化模型" class="headerlink" title="VolcanoPlanner(基于成本的优化模型)"></a>VolcanoPlanner(基于成本的优化模型)</h4><ul>
<li>遍历所有的规则，选择代价最小的计划</li>
<li>代价是通过关系表达式提供的</li>
<li>并不是所有可能的计划都会计算</li>
<li>当经过指定的迭代未显著提升将停止优化</li>
<li>代价包括行数、I/O和CPU</li>
<li>Statistics用来提高代价评估的准确性</li>
<li>Calcite提供了工具来在统计资源消耗</li>
</ul>
<h2 id="Flink-与-Calcite"><a href="#Flink-与-Calcite" class="headerlink" title="Flink 与 Calcite"></a>Flink 与 Calcite</h2><h3 id="Calcite中Flink中的重要作用"><a href="#Calcite中Flink中的重要作用" class="headerlink" title="Calcite中Flink中的重要作用"></a>Calcite中Flink中的重要作用</h3><p><img src="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418224641.png" alt="在这里插入图片描述"></p>
<p>在Flink中，Calcite扮演着重要的角色：</p>
<ul>
<li>以Calcite Catalog为核心，上面承载了Table/SQL API</li>
<li>Flink SQL和Table的代码最后生成Calcite Logic Plan(SqlNode Tree)</li>
<li>随后验证、优化为 RelNode 树，</li>
<li>最终通过 Rules（规则）和 Convention（转化特征）生成具体的 DataSet Plan（批处理）或 DataStream Plan（流处理），即 Flink 算子构成的处理逻辑。</li>
</ul>
<p><img src="https://gitee.com/averyzhang/pic-go/raw/master/img/20210418225006.png" alt="在这里插入图片描述"></p>
<p>Table / SQL API 的编程框架如下：</p>
<ul>
<li><p>通过 TableEnvironment 配置 CalciteConfig 对象，自动设置 SQL &amp; Table API 默认处理参数。</p>
</li>
<li><p>使用 registerTableSource() 来将一个 TableSource 注册到 rootSchema. 后续可以通过 scan() 获取此 Table 并调用各种 Table API 进行处理。</p>
</li>
<li><p>接下可以调用 sqlQuery() 和 sqlUpdate() 方法来使用 SQL 语句进行数据处理。</p>
</li>
</ul>
<h3 id="Flink-SQL的执行流程"><a href="#Flink-SQL的执行流程" class="headerlink" title="Flink SQL的执行流程"></a>Flink SQL的执行流程</h3><p><code>Planner接口</code>: 解析SQL，转换为Transformation</p>
<p><code>Executor接口</code>: 将Planner转换的Transformation生成streamGraph并执行</p>
<p><code>Parser接口</code>: 负责SQL解析，parse方法将SQL语句转换为Operation数组</p>
<ul>
<li>通过Calcite将SQL解析为SqlNode</li>
<li>根据SqlNode的类型，将SqlNode转换为Operation数组</li>
</ul>
<p>DDL语句的转换过程:</p>
<p>SqlNode转换为RelNode:</p>
<ul>
<li>推断Table类型</li>
<li>推断计算列</li>
<li>推断watermark分配</li>
</ul>
<p>SQL转换:</p>
<ol>
<li>Operation-&gt;RelNode</li>
<li>优化RelNode</li>
<li>RelNode-&gt;ExecNode</li>
<li>ExecNode-&gt;Transformation算子</li>
</ol>
<p>[参考文献]</p>
<ol>
<li>[Parsing database Query with Apache Calcite](<a target="_blank" rel="noopener" href="https://blog.knoldus.com/parsing-database-query-with-apache-calcite/">Parsing database Query with Apache Calcite - Knoldus Blogs</a>)</li>
<li><a target="_blank" rel="noopener" href="https://www.slideshare.net/julianhyde/apache-calcite-one-planner-fits-all">Apache Calcite: One planner fits all (slideshare.net)</a></li>
</ol>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Flink/" rel="tag"># Flink</a>
              <a href="/tags/Calcite/" rel="tag"># Calcite</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/bigdata/Flink/Flink-SQL-Window/" rel="prev" title="Flink sql window">
      <i class="fa fa-chevron-left"></i> Flink sql window
    </a></div>
      <div class="post-nav-item">
    <a href="/Java/collection/ConcurrentSkipListMap/" rel="next" title="">
       <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Flink-API%E4%B8%8EFlink-SQL%E7%AE%80%E4%BB%8B"><span class="nav-number">1.</span> <span class="nav-text">Flink API与Flink SQL简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Calcite"><span class="nav-number">2.</span> <span class="nav-text">Calcite</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Calcite%E7%AE%80%E4%BB%8B"><span class="nav-number">2.1.</span> <span class="nav-text">Calcite简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E7%9A%84%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B"><span class="nav-number">2.2.</span> <span class="nav-text">查询的执行过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Catalog"><span class="nav-number">2.3.</span> <span class="nav-text">Catalog</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SQL-parser"><span class="nav-number">2.4.</span> <span class="nav-text">SQL parser</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Query-optimizer"><span class="nav-number">2.5.</span> <span class="nav-text">Query optimizer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="nav-number">2.6.</span> <span class="nav-text">核心概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Planner-%E8%A7%84%E5%88%92%E5%99%A8"><span class="nav-number">2.7.</span> <span class="nav-text">Planner(规划器)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#HepPlanner-%E5%90%AF%E5%8F%91%E5%BC%8F%E4%BC%98%E5%8C%96%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.7.1.</span> <span class="nav-text">HepPlanner(启发式优化模型)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">2.7.2.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VolcanoPlanner-%E5%9F%BA%E4%BA%8E%E6%88%90%E6%9C%AC%E7%9A%84%E4%BC%98%E5%8C%96%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.7.3.</span> <span class="nav-text">VolcanoPlanner(基于成本的优化模型)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Flink-%E4%B8%8E-Calcite"><span class="nav-number">3.</span> <span class="nav-text">Flink 与 Calcite</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Calcite%E4%B8%ADFlink%E4%B8%AD%E7%9A%84%E9%87%8D%E8%A6%81%E4%BD%9C%E7%94%A8"><span class="nav-number">3.1.</span> <span class="nav-text">Calcite中Flink中的重要作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Flink-SQL%E7%9A%84%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="nav-number">3.2.</span> <span class="nav-text">Flink SQL的执行流程</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">aaronzhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">239</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">128</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">aaronzhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
